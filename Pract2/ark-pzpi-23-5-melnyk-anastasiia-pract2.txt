МІНІСТЕРСТВО НАУКИ І ОСВІТИ УКРАЇНИ

ХАРКІВСЬКИЙ НАЦІОНАЛЬНИЙ
УНІВЕРСИТЕТ РАДІОЕЛЕКТРОНІКИ


Кафедра «Програмна інженерія»



ЗВІТ
з практичної роботи №2
з дисципліни «Аналіз та рефакторинг коду»










Виконала:                                                                    Прийняв:
cт. гр. ПЗПІ-23-5                                                         ст. викладач кафедри ПІ:        
Мельник А.О.                                                              Сокорчук Ігор Петрович










Харків 2025
  1 ІСТОРІЯ ЗМІН
  
  №  Дата  Версія звіту  Опис змін та виправлень  1  01.12.2025  0.1Створено розділ «Завдання»  2  03.12.2025  0.5Додано опис методів рефакторингу та приклади коду  3  06.12.2025  1.0Оформлено додатки, додано посилання на відео  
  2 ЗАВДАННЯ
  
  Згідно з методичними вказівками, необхідно:
  • Ознайомитись із теоретичними основами рефакторингу коду за Мартіном Фаулером.
  • Обрати три методи рефакторингу, актуальних для об'єктно-орієнтованого програмування.
  • Продемонструвати застосування цих методів на прикладах мовою Ruby/Ruby on Rails.
  • Для кожного методу надати: опис проблеми (Code Smell), код до та після змін, аналіз переваг.
  • Підготувати презентацію та оформити звіт.
  У цій роботі розглядаються методи: Move Method, Move Field та Remove Parameter.
  
  3 ОПИС ВИКОНАНОЇ РОБОТИ
  
  У ході виконання роботи було проаналізовано типові архітектурні проблеми в Ruby-проєктах та шляхи їх вирішення за допомогою рефакторингу.
  
  3.1 Move Method (Переміщення методу)
  
  Опис проблеми: Метод класу звертається до даних іншого класу частіше, ніж до власних. Цей «запах» коду називається Feature Envy (Заздрість до функцій). Це призводить до високої зв'язності (High Coupling) між класами.
  Код до рефакторингу: Метод shipping_cost у класі Order містить логіку, яка повністю залежить від атрибутів класу Address. (Див. Додаток В.1)
  Пояснення змін: Метод переміщено до класу Address та перейменовано на shipping_cost_for(order). У класі Order залишено лише делегування виклику.
  Переваги:
  • Логіка розрахунку вартості доставки інкапсульована там, де знаходяться дані (в адресі).
  • Клас Order став меншим і чистішим.
  
  3.2 Move Field (Переміщення поля)
  
  Опис проблеми: Поле (або група полів) використовується іншим класом частіше, ніж тим, у якому воно визначене. У контексті Ruby on Rails це часто проявляється як «роздування» моделі атрибутами, що логічно належать іншій сутності (наприклад, адреса користувача зберігається прямо в таблиці users).
  Код до рефакторингу: Модель Person містить поля address_line1, city, zip та валідації для них. (Див. Додаток В.2)
  Пояснення змін: Створено нову модель Address. Поля перенесено до неї. У моделі Person встановлено зв'язок belongs_to :address. Використано делегування методів.
  Переваги:
  • Нормалізація бази даних.
  • Можливість повторного використання сутності Address для інших моделей (наприклад, Store або Office).
  
  3.3 Remove Parameter (Видалення параметру)
  
  Опис проблеми: Метод приймає параметр, який він може отримати іншим шляхом (наприклад, через інший параметр або власні поля). Зайві параметри ускладнюють сигнатуру методу та збільшують ймовірність помилки при виклику.
  Код до рефакторингу: Метод process(order, user) приймає користувача окремим аргументом, хоча user вже є властивістю об'єкта order. (Див. Додаток В.3)
  Пояснення змін: Параметр user видалено з сигнатури методу. Всередині методу значення отримується як order.user.
  Переваги:
  • Спрощення API методу.
  • Усунення ризику передачі невідповідного користувача (розсинхронізація даних).
  
  3.4 Інструментарій
  
  Для автоматизації та контролю якості рефакторингу в Ruby рекомендовано використовувати:
  • Reek: для виявлення Code Smells (зокрема Feature Envy).
  • RSpec: для написання тестів, що гарантують незмінність зовнішньої поведінки системи.
  • RubyMine: IDE з вбудованими інструментами безпечного рефакторингу.

  4 ВИСНОВКИ
  
  Під час виконання практичної роботи було закріплено знання про методи рефакторингу коду. Встановлено, що:
  • Move Method допомагає боротися з високою зв'язністю класів.
  • Move Field дозволяє краще організувати дані та дотримуватися принципів нормалізації.
  • Remove Parameter робить інтерфейси методів чистішими та зрозумілішими.
  Застосування цих методів у поєднанні з автоматизованим тестуванням (TDD) дозволяє підтримувати кодову базу Ruby-проєктів у стані, придатному до розширення та підтримки.
  
  5 СПИСОК ВИКОРИСТАНИХ ДЖЕРЕЛ
  
• Fowler M., Beck K., Brant J., Opdyke W., Roberts D. Refactoring: Ruby Edition. Addison-Wesley Professional, 2009.
• Refactoring.com Catalog [Електронний ресурс]. – Режим доступу: https://refactoring.com/catalog/
• Reek Documentation [Електронний ресурс]. – Режим доступу: https://github.com/troessner/reek
• Thoughtbot. Ruby Science: Refactoring [Електронний ресурс]. – Режим доступу: https://thoughtbot.com/upcase/ruby-science

























Додаток А
Посилання на відеозапис доповіді

Посилання на YouTube: https://youtu.be/lBpD3BVP6cs 
Хронологія відео:
00:00 - Вступ: Тема доповіді (Move Method, Move Field та Remove Parameter)
00:13 - Зміст презентації
00:34 - Що таке рефакторинг за Фаулером: визначення, цілі та принципи
01:11 - Move Method: теорія та проблема Feature Envy
01:38 - Move Method: приклад коду на Ruby (до та після)
02:11 - Move Field: теорія, застосування в Ruby on Rails
02:32 - Move Field: приклад з Rails-моделями (класи Person та Address)
03:07 - Remove Parameter: теорія, спрощення сигнатури методу
03:28 - Remove Parameter: приклад на Ruby (клас OrderProcessor)
04:00- Порівняння методів: коли і що обрати
04:24 - Інструменти та підходи (Reek, RuboCop, RSpec, RubyMine)
05:02 - Список використаних джерел та завершення

Додаток Б
Слайди презентації


Рисунок Б.1 – Слайд 1. Титульна сторінка


Рисунок Б.2 – Слайд 2. Зміст презентації


Рисунок Б.3 – Слайд 3. Вступ


Рисунок Б.4 – Слайд 4. Move Method: теорія

Рисунок Б.5 – Слайд 5. Move Method: приклад


Рисунок Б.6 – Слайд 6. Move Field: теорія


Рисунок Б.7 – Слайд 7. Move Field: приклад


Рисунок Б.8 – Слайд 8. Remove Parameter: теорія


Рисунок Б.9 – Слайд 9. Remove Parameter: приклад


Рисунок Б.10 – Слайд 10. Порівняння методів


Рисунок Б.11– Слайд 11. Інструменти


Рисунок Б.12 – Слайд 12. Список використаних джерел

ДОДАТОК В 
Програмний код

В.1 Move Method

До рефакторингу:

class Order
  attr_reader :address
  # ... initialize ...

  def shipping_cost
    if @address.country == "US"
      10.00
    else
      20.00
    end
  end
end

Після рефакторингу:

class Order
  # ...
  def shipping_cost
    @address.shipping_cost_for(self)
  end
end

class Address
  attr_reader :country
  # ...
  def shipping_cost_for(order)
    if country == "US"
      10.00
    else
      20.00
    end
  end
end

В.2 Move Field

До рефакторингу (Person.rb):

class Person < ApplicationRecord
  validates :first_name, presence: true
  # Адреса прямо в людині
  validates :address_line1, presence: true
  validates :city, presence: true
  validates :zip, presence: true
end

Після рефакторингу:

# person.rb
class Person < ApplicationRecord
  belongs_to :address
  delegate :full_address, to: :address
end

# address.rb
class Address < ApplicationRecord
  has_many :people
  validates :address_line1, :city, :zip, presence: true
end

В.3 Remove Parameter

До рефакторингу:

class OrderProcessor
  def process(order, user)
    # user передається, хоча order.user доступний
    puts "Processing order #{order.id} for user #{user.name}"
    order.complete_by(user)
  end
end

Після рефакторингу:

class OrderProcessor
  def process(order)
    user = order.user # Отримуємо з контексту
    puts "Processing order #{order.id} for user #{user.name}"
    order.complete_by(user)
  end
end


